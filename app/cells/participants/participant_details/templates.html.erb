<% @extra_template.each do |extra| %>
    <%= render extra %>
<% end %>

<%= render_cell "contactable", :templates %>

<script type="text/template" id="person-tab-layout-template">
    <div class="tab-content">
        <div class="tab-pane  active" id="invite-tab">
            <div id="invite-view">
                <div class="empty-tab">
                    <i class="fa fa-angle-up"></i>
                    <i class="glyphicon glyphicon-user"></i>
                    &nbsp;<%= t 'select-person-from-list' %>
                </div>
            </div>
        </div>
        <div class="tab-pane" id="contacts-tab">
            <div id="contacts-view"></div>
        </div>
        <div class="tab-pane" id="published-info-tab">
          <div id="published-info-view"></div></div>
        <div class="tab-pane" id="tags-tab">
            <div id="tags-view"></div>
        </div>
        
        <div class="tab-pane " id="surveys-tab">
            <%= render_cell "participants/survey_review", :tab_display %>            
        </div>
        <div class="tab-pane" id="availability-tab">
            <section>
                <div id="availability-div"></div>
                <%= t "do-not-schedule-against:" %>
                <div id="exclusion-items-div"></div>
                <%= t "do-not-schedule-at:" %>
                <div id="exclusion-times-div"></div>
            </section>
        </div>
        <div class="tab-pane" id="items-tab"><div id="items-view"></div></div>
        <div class="tab-pane" id="emails-tab">
            <%= render_cell "communications/mail_history", :display %>
        </div>
        <% @extra_tab_template.each do |extra| %>
            <%= render extra %>
        <% end %>
    </div>
</script>

<script type="text/template" id="bio-image-form-template">
    <form class="form-horizontal" role="form">
        <fieldset>
            <div class="form-group">
                <div class="row">
                    <label class="col-sm-4 control-label">
                       <%= (I18n.t "bio-image").html_safe %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= (I18n.t "bio-image").html_safe %>' data-container='body' data-trigger='hover' data-placement='right auto' data-toggle='popover' data-content='<%= (I18n.t "bio-image-upload-help").html_safe %>'></i>
                    </label>
                </div>
                <span data-editor>
                    <div class="row">
                        <div class="col-sm-12"><span data-editors="bio_picture"></span></div>
                    </div>
                </span>
            </div>
        </fieldset>
    </form>
</script>

<script type="text/template" id="person-form-template">
    <form class="form-horizontal" role="form">
        <fieldset>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                   <%= t  "name" %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "name" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "name-help" %>'></i>
                </label>
                <div class="col-sm-8">
                    <div data-editor>
                        <div class="row">
                            <div class="col-sm-2">
                                <div class="field-prefix">
                                    <div data-editors="prefix"></div>
                                    <div class="has-error"><p class="help-block" data-error></p></div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="field-first_name">
                                    <div data-editors="first_name"></div>
                                    <div class="has-error"><p class="help-block" data-error></p></div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="field-last_name">
                                    <div data-editors="last_name" class="mandatory-field"></div>
                                    <div class="has-error"><p class="help-block" data-error></p></div>
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <div class="field-suffix">
                                    <div data-editors="suffix"></div>
                                    <div class="has-error"><p class="help-block" data-error></p></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-8 col-sm-offset-4" style="margin-top: -15px; padding-left: 10px; margin-bottom: 15px;">
                <div style="display: inline; margin-right: 5px;" data-editors="has_pseudonym"></div><%= t 'show-pseudonym-versions' %>
            </div>
            <div class="form-group" id="short-version-div">
                <label class="col-sm-4 control-label">
                    <%= t "publication-name" %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "publication-name" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "publication-name-help" %>'></i>
                </label>
                <div class="col-sm-8">
                    <div data-editor>
                        <div class="row">
                            <div class="col-sm-2"><div data-editors="pseudonym.prefix"></div></div>
                            <div class="col-sm-4"><div data-editors="pseudonym.first_name"></div></div>
                            <div class="col-sm-4">
                              <div data-editors="pseudonym.last_name"></div>
                            </div>
                            <div class="col-sm-2"><div data-editors="pseudonym.suffix"></div></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <%= t "company-information" %>
                </label>
                <div class="col-sm-4" data-editors="company"></div>
                <div class="col-sm-4" data-editors="job_title"></div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <%= t('primary-email-address') %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "primary-email-address" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "person-primary-email-address-help" %>'></i>
                </label>
                <div class="field-default_email_address_email col-sm-4" style="padding-top: 6px;">
                  <label>
                    <%= t('email') %>
                  </label>
                  <div title="<%= t('email') %>" class="input-xlarge">
                    <div data-editors="default_email_address.email"></div>
                    <div class="has-error"><p class="help-block" data-error></p></div>
                  </div>
                </div>
                <div class="field-default_email_address_label col-sm-4" style="padding-top: 6px;">
                  <label>
                    <%= t('label') %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "label" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "email-label-help" %>'></i>
                  </label>
                  <div title="<%= t('label') %>" class="input-xlarge">
                    <div data-editors="default_email_address.label"></div>
                    <div class="has-error"><p class="help-block" data-error></p></div>
                  </div>
                </div>
                <div data-editors="default_email_address.isdefault"></div>
            </div>
            <hr class="understated-separator">
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <%= t "invitation-category" %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "invitation-category" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "invitation-category-help" %>'></i>
                </label>
                <div class="col-sm-4" data-editors="invitation_category_id"></div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <%= t "invitation-status" %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "invitation-status" %>' data-container='body' data-trigger='hover' data-placement='right' data-toggle='popover' data-content='<%= t "invitation-status-help" %>'></i>
                </label>
                <div class="col-sm-4" data-editors="invitestatus_id"></div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <%= t "acceptance-status" %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "acceptance-status" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "acceptance-status-help" %>'></i>
                </label>
                <div class="col-sm-4" data-editors="acceptance_status_id"></div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">
                    <%= t "comments" %> <i class="glyphicon glyphicon-info-sign bpopover" title='<%= t "comments" %>' data-container='body' data-trigger='hover' data-placement='top' data-toggle='popover' data-content='<%= t "comments-help" %>'></i>
                </label>
                <div class="col-sm-8" data-editors="comments"></div>
            </div>
        </fieldset>
    </form>
</script>

<script type="text/template" id="summary-layout-template">
    <section>
        <div id="id-region-div"></div>
        <div id="reg-region-div"></div>
    </section>
</script>

<script type="text/template" id="registration-view-template">
    <div class="col-md-4" id="registration-view-details">  
        <h5><%= t "registration"%> <i class="glyphicon glyphicon-info-sign bpopover" title="<%= t "registration"%>" data-toggle="popover" data-trigger="hover" data-placement="top"  data-content="<%= t "registration-help" %>"></i></h5>  
        {{ if (typeof id != 'undefined') { }}
            <button class="model-delete-button btn btn-danger btn-xs pull-right" data-toggle="tooltip" data-trigger="hover" title="<%= t('delete') %>"><i class="fa fa-trash"></i></button>
            <button class="model-edit-button btn btn-primary btn-xs pull-right"><%= t "edit" %></button>
            <dl class="dl-horizontal-small dt50">
                <dt><%= t "registered" %></dt>
                <dd>
                  {{ if (registered) { }}
                      <span class="label label-success"><i class="fa fa-check" aria-hidden="true"></i> <%= t "yes" %></span>
                    {{ } else { }}
                      <span class="label label-default"><i class="fa fa-times" aria-hidden="true"></i> <%= t "no" %></span>
                  {{ } }}
                </dd>
                {{ if (registered) { }}
                  <dt><%= t "reg-number" %></dt>
                  <dd>{{= registration_number ? registration_number : "<span class='minor-text'>(<%= t 'unknown' %>)</span>" }}</dd>
                  <dt><%= t "reg-type" %></dt>
                  <dd>{{= registration_type ? registration_type : "<span class='minor-text'>(<%= t 'unknown' %>)</span>" }}</dd>
                  <dt class="dt-breaking"><%= t "can-share-details" %> <i class="glyphicon glyphicon-info-sign bpopover" data-toggle="popover" data-trigger="hover" title="<%= t "can-share-details" %>" data-content="<%= t 'can-share-details-hint' %>"></i></dt>
                  <dd>{{= can_share ? '<%= t "yes" %>' : '<%= t "no" %>' }}</dd>
                {{ } }}
            </dl>       
        {{ } else { }}
            <button class="model-new-button btn btn-primary btn-xs pull-right">
                <i class="fa fa-plus"></i> <%= t('add') %>
            </button>
            <dl class="dl-horizontal-small dt50">
                <span class="minor-text">(<%= t "no-registration-details" %>)</span>
            </dl>
        {{ }; }}
    </div>
</script>

<script type="text/template" id="invite-view-template">
    <div class="col-md-3">
        <h5>Identification</h5>
        <button class="model-edit-button btn btn-primary btn-xs pull-right"><i class="glyphicon glyphicon-pencil"></i></button>
        <p>
            {{ if (first_name || last_name) { }}
                <strong>{{= prefix ? prefix : "" }} {{= first_name ? first_name : "" }} {{= last_name ? last_name : "" }} {{= suffix ? suffix : "" }}</strong>
                <br>
            {{ } }}  
            {{ if (typeof pseudonym != 'undefined') { }}  
                {{ if (pseudonym.first_name || pseudonym.last_name) { }}
                    <strong>{{= pseudonym.prefix ? pseudonym.prefix : "" }} {{= pseudonym.first_name ? pseudonym.first_name : "" }} {{= pseudonym.last_name ? pseudonym.last_name : "" }} {{= pseudonym.suffix ? pseudonym.suffix : "" }}</strong>
                    <span class="minor-text">(<%= t "published-name" %>)</span>
                    <br>
                {{ } }}    
            {{ } }}    
            {{= job_title ? job_title : '<span class="minor-text"><%= t "no-job-title-specified" %></span>' }}<br>
            {{= company ? company : '<span class="minor-text"><%= t "no-company-specified" %></span>' }}
        </p>
        <p><span class="label label-default">Participant</span></p>
    </div>

    <div class="col-md-5">
        <h5><%= t "invitation-status"%> <i class="glyphicon glyphicon-info-sign bpopover" data-placement="top" data-toggle="popover" title="<%= t "invitation-status"%>" data-trigger="hover" data-content="<%= t "invitation-status-help" %>"></i></h5>
        <button class="model-edit-button btn btn-primary btn-xs pull-right"><i class="glyphicon glyphicon-pencil"></i></button>
        {{ if (typeof id != 'undefined') { }}
            {{ if (!survey_key) { }}
            <p>
                <button class="model-generate-invite-key-button btn btn-primary btn-xs pull-right"><%= t "generate-invite-key" %></button>
            </p>
            {{ } }}
            <dl class="dl-horizontal-small dt50">
                <dt><%= t "invite-status" %></dt>
                <dd>{{= invitestatus_name ? invitestatus_name : "&nbsp;"}}</dd>
                <dt><%= t "acceptance-status" %></dt>
                {{ if (acceptance_status_name == 'Accepted') { }}
                    <dd><span class="label label-success"><span class="glyphicon glyphicon-ok"></span> <%= t "person-acceptance-accepted" %></span></dd>
                    {{ } else if (acceptance_status_name == 'Declined')  { }}
                    <dd><span class="label label-danger"><span class="glyphicon glyphicon-remove"></span> <%= t "person-acceptance-declined" %></span></dd>
                    {{ } else if ((acceptance_status_name == 'Unknown') || (acceptance_status_name == 'Probable'))  { }}
                    <dd><span class="label label-default"> <%= t "person-acceptance-unknown" %></span></dd>                    
                    {{ } else { }}
                    <dd>{{= acceptance_status_name ? acceptance_status_name : "&nbsp;"}}</dd>
                {{ } }}    
                <dt><%= t "invitation-category" %></dt>
                <dd>{{= invitation_category_name ? invitation_category_name : "&nbsp;"}}</dd>
                <dt><%= t "survey-key" %></dt>
                <dd>{{= survey_key }}</dd>
                <dt><%= t "comments" %></dt>
                <dd>{{= comments }}</dd>
            </dl>
        {{ }; }}
    </div>
</script>

<script type="text/template" id="published-info-layout-template">
    <section>
        <h3 class="h3-underlined"><%= t 'public-profile' %>
          <a href="#" id="share-profile-btn" class="btn btn-primary btn-sm pull-right"><i class="fa fa-share-alt"></i> <%= t('share-this-public-profile') %></a>
        </h3>
    </section>
    <section>
        <div class="row">
          <div id="picture-region-div" class="col-md-3"></div>
          <div id="bio-region-div" class="col-md-9"></div>
        </div>
    </section>
</script>

<script type="text/template" id="bio-image-template">
    <div>
        <h5>
          <%= t "published-picture" %>
          <i class="glyphicon glyphicon-info-sign bpopover" data-placement="top auto" data-toggle="popover" title="" data-trigger="hover" data-content="<%= t 'tip-published-picture' %>" data-original-title="<%= t 'published-picture' %>"></i>
        </h5>
        <% if ConfigService.hasCloudinaryConfig? %>
        <div>
            {{ if (typeof id != 'undefined') { }}
            <div align="left" class="voffset10">
                  {{ if (bio_picture &&  (typeof bio_picture.standard != 'undefined') ) { }}
            	       <image src="{{= bio_picture.standard.url }}" class="img-responsive img-rounded" id="bio-picture-image"></image>
            	    {{ } }}
            </div>
            <div class="caption voffset5">
                <p><%= t "bio-image" %>
                    <button class="model-delete-button btn btn-danger btn-xs pull-right">
                        <i class="glyphicon glyphicon-trash"></i>
                    </button>
                    <button class="model-edit-button btn btn-primary btn-xs pull-right">
                        <i class="glyphicon glyphicon-pencil"></i>
                    </button>
                </p>
            </div>
            {{ } else { }}
            <div class="caption">
                <p>
                    <span class="minor-text"><%= t "no-bio-image" %></span>
                    <button class="model-new-button btn btn-primary btn-xs pull-right">
                        <i class="glyphicon glyphicon-pencil"></i>
                    </button>
                </p>
            </div>
            {{ }; }}
        </div>
        <% else %>
            <%= t 'cloudinary-not-configured' %>
        <% end %>
    </div>
</script>

<script type="text/template" id="bio-view-template">
        <h5>
          <%= t 'biography-and-social-media-links' %>
          <i class="glyphicon glyphicon-info-sign bpopover" data-placement="top auto" data-toggle="popover" title="" data-trigger="hover" data-content="<%= t 'tip-published-bio' %>" data-original-title="<%= t 'biography-and-social-media-links' %>"></i>
        </h5>
        {{ if (typeof id != 'undefined') { }}
            <button class="model-edit-button btn btn-primary btn-xs pull-right"><span class="glyphicon glyphicon-pencil"></span></button>
            <dl class="dl-airy">
                <dt><%= t "bio" %>{{= bio ? ' <span class="minor-text"> (<%= t "biography-edited" %>)</span>' : (survey_bio ? ' <span class="minor-text"> (<%= t "biography-filled-out-by-person-on-the-survey" %>)</span>' : '&nbsp;') }}</dt>
                <dd>{{= bio ? bio : (survey_bio ? survey_bio : "<span class='minor-text'><%= t 'none-provided' %></span>") }}</dd>
                <%= render_cell "sociable", :template_icons %>
            </dl>
        {{ } else { }}
            <button class="model-new-button btn btn-primary btn-xs pull-right"><span class="glyphicon glyphicon-pencil"></span></button>
            <p><span class="minor-text"><%= t "no-public-profile" %></span></p>
            {{ if (survey_bio) { }}
              <dl class="dl-airy">
                  <dt><%= t "bio-from-survey" %></dt>
                  <dd>{{= survey_bio ? survey_bio : "&nbsp;" }}</dd>
              </dl>
            {{ } }}
        {{ }; }}

</script>


<script type="text/template" id="exclusions-layout-template">
<section>
    <div id="dates-exclusions-div"></div>
    <%= t "do-not-schedule-against:" %>
    <div id="items-exclusions-div"></div>
    <%= t "do-not-schedule-at:" %>
    <div id="times-exclusions-div"></div>
</section>
</script>

<script type="text/template" id="tag-context-layout-template">
<div class="thumbnail clearfix">
    <button class="model-add-tag-button btn btn-primary btn-xs pull-right" tagcontext="{{= context }}">
        <%= t "add" %>
    </button>
    <span class="label label-default">{{= context }}</span>
    {{ _.each(tags, function(tag) { }}
    <span class="label label-info">{{= tag }} <a href="{{= '<%= baseUri %>/tags/' + obj_id + '/remove?class=Person&context=' + context + '&tag=' + tag }}" class="tag-remove-link"><i class="glyphicon glyphicon-remove"></i></a></span>
    {{ }); }}
</div>
</script>

<script type="text/template" id="tag-cloud-context-layout-template">
<div class="panel-group" id="participant-tag-cloud-parent">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h5 class="panel-title tag-panel-title">
                <a data-toggle="collapse" data-parent="#participant-tag-cloud-parent" href="#{{= context }}">{{= context }}</a>
            </h5>
        </div>
        <div id="{{= context }}" class="panel-collapse collapse">
            <div class="panel-body">
                {{ _.each(tags, function(tag) { }}
                <span class="label label-info select-tag-button" tagcontext="{{= context}}" tagname="{{= tag.name}}">{{= tag.name }} {{= tag.count }}</span>
                {{ }); }}
            </div>
        </div>
    </div>
</div>
</script>

<script type="text/template" id="date-exclusion-view-template">
{{ if (typeof id != 'undefined') { }}
<div class="thumbnail clearfix">
    <button class="model-delete-button btn btn-primary btn-xs pull-right">
        <%= t "delete" %>
    </button>
    <button class="model-edit-button btn btn-primary btn-xs pull-right">
        <%= t "edit" %>
    </button>
    <small> <em><%= t 'arrival'%></em>: {{= start_time_str }} <i class="glyphicon glyphicon-arrow-right"></i> <em><%= t 'departure'%></em>: {{= end_time_str }} </small>
</div>
{{ } else { }}
    <button class="model-new-button btn btn-primary btn-xs pull-right">
        <%= t "new" %>
    </button>
{{ }; }}
</script>

<script type="text/template" id="item-exclusion-view-template">
<div class="thumbnail clearfix">
    <small> {{= title }} </small>
</div>
</script>

<script type="text/template" id="time-exclusion-view-template">
  {{ if (typeof id != 'undefined') { }}
  <div class="thumbnail clearfix">
    <button class="model-delete-button btn btn-primary btn-xs pull-right">
        <%= t "delete" %>
    </button>
      <button class="model-edit-button btn btn-primary btn-xs pull-right">
          <%= t "edit" %>
      </button>
      <small> {{= start_str }} <i class="glyphicon glyphicon-arrow-right"></i> {{= end_str }} </small>
  </div>
  {{ } else { }}
      <button class="model-new-button btn btn-primary btn-xs pull-right">
          <%= t "new" %>
      </button>
  {{ }; }}
</script>

<script type="text/template" id="program-item-view-template">
    {{ if (typeof id != 'undefined') { }}
            <td>
                    <strong>
                        {{ if (isPublished) { }}
                            <a href="#">
                        {{ }; }}
                    {{= title ? title : "&nbsp;" }}
                        {{ if (isPublished) { }}
                            </a>
                        {{ }; }}
                    </strong> ({{= role ? role : "&nbsp;" }})<br>
                {{ if (parent_id == null) {  }}
                    {{= time_slot ? start_time_str : '<span class="minor-text"><%= t "no-date-and-time-specified" %></span>' }}
                    {{ if (room) { }}
                        {{= '<br>' + room.name }} {{= venue ? '(' + venue.name + ')' : '' }}
                    {{ } }}
                    {{ if ((typeof other_participants.join(", ") != 'undefined') && other_participants.join(", ").length > 1) { }}
                        <br>
                        <strong><%= t "with"%> </strong><em>{{= other_participants.join(", ") }}</em>
                    {{ }; }}
                {{ } else { }}
                    <%= t 'part-of' %> <strong><a href="#">{{= parent_val.title }}</a></strong><br>
                    {{= parent_val.time_slot ? parent_val.start_time_str : '<span class="minor-text"><%= t "no-date-and-time-specified" %></span>' }}
                    {{ if ( parent_val.room) { }}
                        {{= '<br>' + parent_val.room.name }} {{= parent_val.venue ? '(' + parent_val.venue.name + ')' : '' }}
                    {{ } }}
                {{ }; }}
            </td>
            <td align="right">
                <nobr>{{= isPublished ? '<div class="default-label"><span class="glyphicon glyphicon-ok"></span> <%= t "published" %></div>' : ''}}</nobr>
            </td>
    {{ }; }}
</script>


<script type="text/template" id="participant-filters-template">
    <span class="label label-info remove-filter-button filter-remove-button" tagcontext="{{= context}}" tagname="{{= name }}">{{= name }}<i class="glyphicon glyphicon-remove"></i></span>
</script>



